{% extends 'includes/layout.html' %}
{% load i18n l10n lots permissions users commons %}
{% block conteudo %}

<div class="container-fluid">
      <div class="row">
        <div class="col-md-1 sidebar">

        </div>
        <div class="col-md-10 main">
          <h1 class="page-header"><i class="fa fa-cart-arrow-down"></i> {{ lot.name }}</h1>
          <div class="row">
              <div class="col-md-4">
                  <p><strong>{% trans "Situação" %}: </strong> {% if lot.status %}<strong>{{ lot.get_status_display  }}</strong>{% endif %}</p>
                  <p><strong>{% trans "Data venda" %}: </strong> {% if lot.sell_date %}{{ lot.sell_date }}{% endif %}</p>
                  <p><strong>{% trans "Custo dos Produtos" %} <span class="help help-tooltip help-icon" title="{% trans 'Soma de todos os &quot;Custos dos Produtos&quot; multiplicados pela &quot;Quantidade&quot; de produtos de cada produto do lote.' %}"></span>: </strong> U$ {{ lot.products_cost|localize }}</p>
                  <p><strong>{% trans "Lucro" %} <span class="help help-tooltip help-icon" title="{% trans 'Soma de todos os &quot;Lucros Totais&quot; dos produtos do lote.' %}"></span>: </strong> U$ {{ lot.profit|localize }}</p>
              </div>
              <div class="col-md-4">
                  <p><strong>{% trans "ROI médio" %} <span class="help help-tooltip help-icon" title="{% trans 'Soma de todos os &quot;ROI&quot; divididos pelo número de produtos do lote.' %}"></span>: </strong> {{ lot.average_roi|localize }}%</p>
                  <p><strong>{% trans "Redirecionamento" %} <span class="help help-tooltip help-icon" title="{% trans 'Este valor é somente informativo, ele será pago no processo de criação do envio por esta plataforma.' %}"></span>: </strong> U$ {{ lot.redirect_cost|localize }}</p>
                  <p><strong>{% trans "Total a pagar" %} <span class="help help-tooltip help-icon" title="{% trans 'Soma de todos os &quot;Valores de Compra&quot; multiplicados pela &quot;Quantidade&quot; de produtos de cada produto do lote.' %}"></span>: </strong> U$ {{ lot.lot_cost|localize }}</p>
              </div>
              <div class="col-md-4">
                  {% if lot.payment_complete is False %}
                  <!-- Aparece apenas para usuarios comuns -->
                    <br><br>
                    {% render_payment_button paypal_form lot.id %}
                  <!-- fim botao compra -->
                  {% endif %}
              </div>
          </div>
          <div class="row">
              <br><h3><i class="fa fa-list-ol"></i> {% trans "Produto(s)" %}</h3><br><br>
          </div>
          <div class="row lista itens">
              {% for product in lot.product_set.all %}
              <div class="col-md-4 item">
                  <div class="col-md-12">
                      <p class="nome"><strong>{% trans "Nome" %}:</strong><br> {{ product.name }}</p>
                  </div>
                  <div class="col-md-12">
                      <p><strong>{% trans "UPC / CODIGO IDENTIFICADOR" %}:</strong><br> {{ product.identifier }}</p>
                  </div>
                  <div class="col-md-6">
                      <p><strong>{% trans "Valor de Compra" %}:</strong><br> U$ {{ product.buy_price|localize }}</p>
                  </div>
                  <div class="col-md-6">
                      <p><strong>{% trans "Quantidade" %}:</strong><br> {{ product.quantity }}</p>
                  </div>
                  <div class="col-md-6">
                      <p><strong>{% trans "Valor de Venda" %}:</strong><br> U$ {{ product.sell_price|localize }}</p>
                  </div>
                  <div class="col-md-6">
                      <p><strong>{% trans "Tarifa FBA" %}:</strong><br> U$ {{ product.fba_fee|localize }}</p>
                  </div>
                  <div class="col-md-6">
                      <p><strong>{% trans "Tarifa Amazon" %}:</strong><br> U$ {{ product.amazon_fee|localize }}</p>
                  </div>
                  <div class="col-md-6">
                      <p><strong>{% trans "Redirecionamento" %}:</strong><br> U$ {{ product.redirect_factor|localize }}</p>
                  </div>
                  <div class="col-md-12">
                      <p><strong>{% trans "Custo de Envio para Amazon" %}:</strong><br> U$ {{ product.shipping_cost|localize }}</p>
                  </div>
                  <div class="col-md-12">
                      <p><strong>{% trans "Custo do Produto" %} <span class="help help-tooltip help-icon" title="{% trans 'Valor informativo que é composto por: &quot;Valor de Compra&quot; mais &quot;Tarifa FBA&quot; mais &quot;Tarifa Amazon&quot; mais &quot;Redirecionamento&quot; mais &quot;Custo de Envio para Amazon&quot;.' %}"></span>:</strong><br> U$ {{ product.product_cost|localize }}</p>
                  </div>

                  <div class="col-md-12">
                      <p><strong>{% trans "Lucro Líquido por Unidade" %} <span class="help help-tooltip help-icon" title="{% trans 'Valor informativo que é composto por: &quot;Valor de Venda&quot; menos &quot;Custo do Produto&quot;.' %}"></span>:</strong><br> U$ {{ product.profit_per_unit|localize }}</p>
                  </div>
                  <div class="col-md-6">
                      <p><strong>{% trans "Lucro Total" %} <span class="help help-tooltip help-icon" title="{% trans 'Valor informativo que é composto por: &quot;Lucro líquido por Unidade&quot; vezes &quot;Quantidade&quot;.' %}"></span>:</strong><br> U$ {{ product.total_profit|localize }}</p>
                  </div>
                  <div class="col-md-6">
                      <p><strong>{% trans "ROI" %} (%):</strong><br> {{ product.roi|localize }}</p>
                  </div>
              </div>
              {% endfor %}
          </div>
            {% if lot.payment_complete is False %}
                <!-- Aparece apenas para usuarios comuns -->
                <br><br>
                {% render_payment_button paypal_form lot.id %}
                <!-- fim botao compra -->

                <br><br>
                {% if user|has_store_perm:'change_lot' %}
                <a href="{%url 'admin:store_lot_change' lot.id %}" class="btn btn-primary"><i class="fa fa-fw fa-pencil"></i> {% trans "Editar" %}</a>
                {% endif %}
                {% if user|has_store_perm:'delete_lot' %}
                <a href="#" class="btn btn-danger send-btn-delete"><i class="fa fa-fw fa-trash"></i> {% trans "Excluir" %}</a><br><br>
                {% endif %}
            {% endif %}
            <a href="javascript:history.back()"><i class="fa fa-fw fa-long-arrow-left"></i> {% trans "Voltar" %}</a>
            <br><br><br>
        </div>
        <div class="col-md-1 sidebar">
        </div>
      </div>
    </div>
    {% if user|has_store_perm:'delete_lot' and lot.payment_complete is False %}
    <form action="{%url 'admin:store_lot_delete' lot.id %}" method="post" class="form-delete-lot" id="form-delete-lot">
    {% csrf_token %}
    <div id="confirmacao-exclusao" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">{% trans "Excluir" %}</h4>
                </div>
                <div class="modal-body">
                    <p>{% trans "Confirma a exclusão do lote?" %}</p>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger">{% trans "Sim" %}</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">{% trans "Fechar" %}</button>
                </div>
            </div>
        </div>
    </div>
    </form>
    {% endif %}
{% endblock %}